namespace dialogs

import apis.APIRequestVolunteer
import com.amazon.alexa.ask.conversations.Affirm
import com.amazon.alexa.ask.conversations.ConfirmAction
import com.amazon.alexa.ask.conversations.Inform
import com.amazon.alexa.ask.conversations.Invoke
import com.amazon.alexa.ask.conversations.MultiModalResponse
import com.amazon.alexa.ask.conversations.Notify
import com.amazon.alexa.ask.conversations.Request
import com.amazon.alexa.ask.conversations.RequestArguments
import com.amazon.alexa.ask.conversations.ensure
import com.amazon.alexa.ask.conversations.expect
import com.amazon.alexa.ask.conversations.response
import com.amazon.alexa.schema.Nothing
import prompts.ConfirmRequestPrompt
import prompts.RequestConfirmedPrompt
import prompts.RequestDatePrompt
import prompts.RequestServicePrompt
import types.PAYLOAD_TYPE0
import types.PAYLOAD_TYPE1
import types.PAYLOAD_TYPE2
import types.PAYLOAD_TYPE3
import utterances.USetAffirm
import utterances.USetInformDate
import utterances.USetInformService
import utterances.USetRequestVolunteer0
import utterances.USetRequestVolunteer1

dialog Nothing dialogName_RequestVolunteer1() {
  sample {
    USetRequestVolunteer1Request = expect(
      act = Invoke,
      event = USetRequestVolunteer1
    )
    response(
      act = ConfirmAction {
        actionName = APIRequestVolunteer
      },
      payload = PAYLOAD_TYPE0 {
        date = USetRequestVolunteer1Request.date,
        service = USetRequestVolunteer1Request.service
      },
      response = MultiModalResponse {
        apla = ConfirmRequestPrompt
      }
    )
    expect(
      act = Affirm,
      event = USetAffirm
    )
    ensure(
      requestArgs = [
        RequestArguments {
          response = MultiModalResponse {
            apla = RequestServicePrompt
          },
          arguments = [
            APIRequestVolunteer.arguments.service
          ]
        }
      ]
    )
    ensure(
      requestArgs = [
        RequestArguments {
          response = MultiModalResponse {
            apla = RequestDatePrompt
          },
          arguments = [
            APIRequestVolunteer.arguments.date
          ]
        }
      ]
    )
    volunteerRequest0 = APIRequestVolunteer(
      date = USetRequestVolunteer1Request.date,
      service = USetRequestVolunteer1Request.service
    )
    response(
      act = Notify {
        success = true,
        actionName = APIRequestVolunteer
      },
      payload = PAYLOAD_TYPE1 {
        volunteerRequest = volunteerRequest0
      },
      response = MultiModalResponse {
        apla = RequestConfirmedPrompt
      }
    )
  }
}

dialog Nothing dialogName_RequestVolunteer0() {
  sample {
    expect(
      act = Invoke,
      event = USetRequestVolunteer0
    )
    response(
      act = Request {
        arguments = [
          APIRequestVolunteer.arguments.service
        ]
      },
      response = MultiModalResponse {
        apla = RequestServicePrompt
      }
    )
    USetInformServiceRequest = expect(
      act = Inform,
      event = USetInformService
    )
    response(
      act = Request {
        arguments = [
          APIRequestVolunteer.arguments.date
        ]
      },
      response = MultiModalResponse {
        apla = RequestDatePrompt
      }
    )
    USetInformDateRequest = expect(
      act = Inform,
      event = USetInformDate
    )
    response(
      act = ConfirmAction {
        actionName = APIRequestVolunteer
      },
      payload = PAYLOAD_TYPE2 {
        date = USetInformDateRequest.date,
        service = USetInformServiceRequest.service
      },
      response = MultiModalResponse {
        apla = ConfirmRequestPrompt
      }
    )
    expect(
      act = Affirm,
      event = USetAffirm
    )
    volunteerRequest0 = APIRequestVolunteer(
      date = USetInformDateRequest.date,
      service = USetInformServiceRequest.service
    )
    response(
      act = Notify {
        success = true,
        actionName = APIRequestVolunteer
      },
      payload = PAYLOAD_TYPE3 {
        volunteerRequest = volunteerRequest0
      },
      response = MultiModalResponse {
        apla = RequestConfirmedPrompt
      }
    )
  }
}
